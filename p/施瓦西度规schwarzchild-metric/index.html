<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="使用mathematica的xAct, xCoba计算求解施瓦西过程中的联络，黎曼张量，Ricci张量等，解出施瓦西度规，同时数值求解施瓦西度规的测地线方程，给出最内层稳定圆周轨道，光线偏折等图像。">
<title>施瓦西度规(Schwarzchild Metric)</title>

<link rel='canonical' href='https://Dawn-19.github.io/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/'>

<link rel="stylesheet" href="/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css"><meta property='og:title' content="施瓦西度规(Schwarzchild Metric)">
<meta property='og:description' content="使用mathematica的xAct, xCoba计算求解施瓦西过程中的联络，黎曼张量，Ricci张量等，解出施瓦西度规，同时数值求解施瓦西度规的测地线方程，给出最内层稳定圆周轨道，光线偏折等图像。">
<meta property='og:url' content='https://Dawn-19.github.io/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/'>
<meta property='og:site_name' content='Dawn-19'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-02-16T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-02-16T00:00:00&#43;00:00'/><meta property='og:image' content='https://Dawn-19.github.io/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/wallhaveny86gzx.jpg' />
<meta name="twitter:title" content="施瓦西度规(Schwarzchild Metric)">
<meta name="twitter:description" content="使用mathematica的xAct, xCoba计算求解施瓦西过程中的联络，黎曼张量，Ricci张量等，解出施瓦西度规，同时数值求解施瓦西度规的测地线方程，给出最内层稳定圆周轨道，光线偏折等图像。"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://Dawn-19.github.io/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/wallhaveny86gzx.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "light");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/photo_hu_7c5c3f8b98e0c7a4.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Dawn-19</a></h1>
            <h2 class="site-description">深刻的思想总是朴素的。</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://arxiv.org/'
                        target="_blank"
                        title="arXiv"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"
 "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
 width="792.000000pt" height="792.000000pt" viewBox="0 0 792.000000 792.000000"
 preserveAspectRatio="xMidYMid meet">
<metadata>
Created by potrace 1.14, written by Peter Selinger 2001-2017
</metadata>
<g transform="translate(0.000000,792.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M1285 7906 c-90 -30 -153 -77 -199 -151 -74 -117 -73 -216 1 -337 13
-21 23 -42 23 -48 0 -5 4 -10 8 -10 4 0 16 -15 27 -32 10 -18 28 -42 38 -53
10 -11 31 -36 45 -55 15 -19 29 -37 32 -40 6 -6 149 -177 167 -200 11 -14 153
-186 212 -257 14 -17 40 -48 56 -69 17 -20 35 -42 40 -48 6 -6 23 -27 38 -46
58 -72 103 -124 120 -142 9 -10 14 -18 10 -18 -5 0 -3 -4 3 -8 6 -4 58 -63
114 -132 56 -69 106 -127 109 -130 4 -3 20 -23 37 -45 16 -22 34 -44 40 -50 6
-5 42 -48 80 -95 38 -47 73 -88 79 -92 5 -4 7 -8 3 -8 -4 0 8 -16 27 -35 19
-19 35 -37 35 -40 0 -4 24 -34 55 -69 6 -6 30 -36 55 -66 25 -30 49 -60 55
-66 5 -6 24 -28 40 -48 17 -21 42 -52 56 -70 49 -58 424 -512 459 -556 19 -24
49 -59 67 -79 17 -20 29 -38 27 -41 -3 -2 -8 1 -13 8 -5 8 -33 -12 -89 -65
-46 -43 -123 -116 -173 -163 -172 -161 -186 -175 -233 -239 -78 -107 -135
-257 -134 -351 0 -19 -1 -39 -3 -45 -6 -21 13 -122 33 -180 46 -130 90 -183
378 -455 78 -74 164 -155 190 -180 l48 -46 -41 -50 c-23 -27 -48 -56 -55 -64
-7 -8 -58 -71 -113 -140 -56 -69 -118 -145 -139 -170 -21 -25 -49 -58 -61 -75
-13 -16 -37 -46 -53 -66 -17 -20 -41 -49 -53 -65 -12 -16 -34 -42 -48 -59 -15
-16 -39 -45 -53 -64 -15 -19 -41 -51 -57 -70 -32 -38 -82 -99 -160 -196 -51
-64 -98 -121 -158 -194 -20 -25 -41 -51 -46 -57 -63 -80 -193 -237 -214 -260
-15 -16 -27 -32 -27 -35 0 -3 -10 -17 -22 -31 -47 -50 -127 -153 -127 -162 0
-5 -3 -12 -9 -15 -22 -14 -62 -143 -66 -208 -13 -287 347 -473 559 -288 26 23
153 140 259 240 45 41 244 226 281 259 17 15 57 53 90 84 33 31 112 104 174
162 62 58 137 128 166 155 29 28 93 86 141 130 49 44 114 105 146 135 31 30
79 75 106 100 26 25 97 90 156 145 60 55 119 110 132 123 13 12 27 22 33 22 5
0 34 -24 64 -52 30 -29 97 -93 148 -142 52 -48 166 -157 254 -241 186 -178
232 -222 419 -399 76 -72 174 -165 217 -206 179 -172 573 -546 809 -770 30
-29 125 -119 210 -200 85 -81 184 -175 220 -209 92 -87 155 -116 250 -116 60
0 85 5 124 25 86 44 141 107 170 197 36 110 11 179 -124 343 -25 30 -51 61
-58 68 -7 8 -25 30 -40 50 -15 20 -34 44 -42 53 -8 9 -24 27 -35 40 -75 91
-120 145 -124 149 -4 3 -24 28 -46 55 -22 28 -45 56 -52 63 -7 7 -29 34 -50
60 -21 26 -42 52 -48 58 -5 6 -26 30 -45 54 -19 24 -40 48 -45 54 -6 6 -30 36
-55 66 -25 30 -47 57 -50 60 -3 3 -22 26 -43 52 -21 26 -43 53 -50 60 -7 7
-44 51 -82 98 -38 47 -74 90 -80 96 -5 6 -23 28 -40 49 -16 20 -35 42 -40 49
-10 10 -260 311 -354 425 -20 24 -48 58 -63 75 -14 17 -155 186 -312 374
l-285 344 36 31 c20 18 53 48 73 67 21 19 81 76 135 125 194 177 284 271 327
340 46 74 85 168 92 226 3 19 5 34 6 34 1 0 3 29 4 65 2 67 -14 163 -35 215
-7 17 -13 36 -15 44 -4 21 -75 133 -109 170 -48 53 -326 324 -496 483 -21 20
-39 39 -39 43 0 5 134 171 150 185 3 3 25 30 50 60 25 30 52 61 60 70 8 8 33
38 55 65 22 28 45 55 51 60 6 6 33 37 60 70 27 33 61 74 75 90 15 17 44 51 65
76 82 96 129 152 139 163 6 6 32 38 59 71 28 33 60 71 72 85 13 14 42 48 64
75 23 28 54 64 69 80 14 17 47 55 71 85 25 30 59 71 77 90 17 19 42 48 55 65
13 16 30 37 38 46 8 8 24 26 35 40 11 13 57 68 103 122 110 130 139 171 172
240 61 127 14 242 -145 349 -104 70 -192 79 -284 27 -47 -26 -135 -96 -201
-159 -9 -8 -51 -46 -94 -85 -43 -38 -88 -79 -100 -90 -146 -134 -204 -186
-222 -202 -12 -10 -63 -56 -115 -103 -51 -47 -103 -94 -115 -105 -118 -106
-272 -246 -325 -295 -15 -14 -55 -50 -89 -80 -34 -30 -74 -66 -89 -80 -38 -35
-134 -123 -225 -205 -43 -38 -101 -91 -129 -117 -29 -27 -55 -48 -59 -48 -6 0
-70 60 -288 270 -43 41 -156 149 -250 240 -95 91 -215 206 -266 255 -52 50
-94 90 -94 89 0 0 -50 47 -110 106 -61 58 -176 169 -257 246 -80 76 -176 168
-213 204 -37 36 -119 114 -181 174 -63 60 -199 190 -303 290 -104 99 -210 201
-236 226 -26 25 -97 93 -158 153 -62 59 -119 107 -127 107 -8 0 -15 5 -15 10
0 6 -6 10 -12 10 -7 0 -24 6 -38 13 -34 17 -136 19 -185 3z m2014 -3200 c-2
-2 -13 8 -23 22 l-19 27 24 -22 c12 -12 21 -24 18 -27z"/>
</g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/Dawn-19'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.overleaf.com/project'
                        target="_blank"
                        title="overleaf"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
  <path d="M9.817 8.036c-4.541 2.709-7.401 7.532-7.593 12.813 0.005 4.14 2.303 7.943 5.973 9.869 3.667 1.927 8.1 1.656 11.516-0.692 3.412-2.349 5.24-6.401 4.745-10.516-0.489-4.115-3.224-7.615-7.095-9.095-1.26-0.509-2.604-0.765-3.957-0.749-2.417 1.631-4.355 3.869-5.615 6.495 1.609-1.921 4.088-2.885 6.572-2.557 2.491 0.328 4.631 1.901 5.688 4.177 1.057 2.271 0.875 4.927-0.473 7.041-1.355 2.109-3.693 3.38-6.199 3.375-2.151 0-4.192-0.937-5.588-2.572-1.808-2.016-2.589-4.756-2.115-7.423 1.432-8.557 11.687-13.489 19.281-15.4-3.516 1.692-6.901 3.64-10.125 5.833 9.177 3.541 10.651-4.183 14.943-7.641-4.271-1.672-19.937-2.287-19.959 7.047z"/>
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/%E7%AE%80%E4%BB%8B/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>简介</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#施瓦西度规的求解">施瓦西度规的求解</a></li>
    <li><a href="#施瓦西度规的测地线方程">施瓦西度规的测地线方程</a></li>
    <li><a href="#数值求解测地线方程">数值求解测地线方程</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/">
                <img src="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/wallhaveny86gzx_hu_6e6092128255c0a0.jpg"
                        srcset="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/wallhaveny86gzx_hu_6e6092128255c0a0.jpg 800w, /p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/wallhaveny86gzx_hu_166ff8129b3ff8e8.jpg 1600w"
                        width="800" 
                        height="500" 
                        loading="lazy"
                        alt="Featured image of post 施瓦西度规(Schwarzchild Metric)" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" >
                学习笔记
            </a>
        
            <a href="/categories/%E7%9B%B8%E5%AF%B9%E8%AE%BA%E4%B8%8E%E5%AE%87%E5%AE%99%E5%AD%A6/" >
                相对论与宇宙学
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/">施瓦西度规(Schwarzchild Metric)</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            使用mathematica的xAct, xCoba计算求解施瓦西过程中的联络，黎曼张量，Ricci张量等，解出施瓦西度规，同时数值求解施瓦西度规的测地线方程，给出最内层稳定圆周轨道，光线偏折等图像。
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 16, 2025</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h1 id="施瓦西度规schwarzchild-metric">施瓦西度规(Schwarzchild Metric)
</h1><h2 id="施瓦西度规的求解">施瓦西度规的求解
</h2><p>根据Birkhoff定理，施瓦西度规是真空爱因斯坦方程的唯一球对称解。因此，为求解这个球对称的时空，总是可以假设取如下度规形式：</p>
$$
\mathrm{d}s^2 = -e^{2F(t,r)}\mathrm{d}t^2 + e^{2G (t,r)} \mathrm{d}r^2 + r^2(\mathrm{d}\theta^2+\sin{^2\theta}\mathrm{d}\phi^2)
$$<p>在Mathematica中，先定义流形，</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">DefManifold</span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="err">\</span><span class="p">[</span><span class="n">Alpha</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Beta</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Gamma</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Delta</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Lambda</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Sigma</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Rho</span><span class="p">]}]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">dimM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DimOfManifold</span><span class="p">[</span><span class="n">M</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">dimM1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dimM</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>由于计算过程中会用到$F(t,t)$和$G(t,r)$两个位置函数，需要先定义这两个标量函数，再定义坐标卡和度规</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][]};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">F</span><span class="p">];</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">G</span><span class="p">];</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gmatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DiagonalMatrix</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="o">-</span><span class="n">Exp</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="n">F</span><span class="p">[</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[]]],</span><span class="w"> </span><span class="n">Exp</span><span class="p">[</span><span class="mi">2</span><span class="w"> </span><span class="n">G</span><span class="p">[</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[]]],</span><span class="w"> </span><span class="n">r</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">r</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">Sin</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]]</span><span class="o">^</span><span class="mi">2</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefChart</span><span class="p">[</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">coords</span><span class="p">,</span><span class="w"> </span><span class="n">ChartColor</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Blue</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CTensor</span><span class="p">[</span><span class="n">gmatrix</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SetCMetric</span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">SignatureOfMetric</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CovDOfMetric</span><span class="p">[</span><span class="n">g</span><span class="p">];</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可以打印度规检查一下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Print</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="s">&#34;\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)=&#34;</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="n">g</span><span class="p">[{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> </span><span class="n">ch</span><span class="p">}]]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">MatrixForm</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Subscript</span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">]</span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="n">F</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">])</span><span class="w">	</span><span class="mi">0</span><span class="w">	</span><span class="mi">0</span><span class="w">	</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">0</span><span class="w">	</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="n">G</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">])</span><span class="w">	</span><span class="mi">0</span><span class="w">	</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">0</span><span class="w">	</span><span class="mi">0</span><span class="w">	</span><span class="n">r</span><span class="o">^</span><span class="mi">2</span><span class="w">	</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="mi">0</span><span class="w">	</span><span class="mi">0</span><span class="w">	</span><span class="mi">0</span><span class="w">	</span><span class="n">r</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">Sin</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">]]</span><span class="o">^</span><span class="mi">2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216172155230.png"
	width="763"
	height="282"
	srcset="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216172155230_hu_d37736e18c93ed82.png 480w, /p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216172155230_hu_c1df24267595abab.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="270"
		data-flex-basis="649px"
	
></p>
<p>接下来计算联络，使用<code>Christoffel[CD, PDch]</code> ，同时把Table把每个非0分量展现出来，这里采用黎曼几何，挠率为0，联络系数的两个下指标是对称的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">Christoffel</span><span class="p">[</span><span class="n">CD</span><span class="p">,</span><span class="w"> </span><span class="n">PDch</span><span class="p">][{</span><span class="err">\</span><span class="p">[</span><span class="n">Alpha</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Beta</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Gamma</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Table</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">If</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">UnsameQ</span><span class="p">[</span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">]],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">Subscript</span><span class="p">[</span><span class="n">Superscript</span><span class="p">[</span><span class="s">&#34;\[CapitalGamma]&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">]]}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Partition</span><span class="p">[</span><span class="n">DeleteCases</span><span class="p">[</span><span class="n">Flatten</span><span class="p">[</span><span class="n">list</span><span class="p">],</span><span class="w"> </span><span class="n">Null</span><span class="p">],</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">TableForm</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216173446644.png"
	width="1213"
	height="878"
	srcset="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216173446644_hu_6cd4355ff2fdee7.png 480w, /p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216173446644_hu_9c4dec4ba2531e97.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="331px"
	
></p>
<p>类似的，计算黎曼张量，和Ricci张量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="c">(*黎曼张量*)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">Riemann</span><span class="p">[</span><span class="n">CD</span><span class="p">][{</span><span class="err">\</span><span class="p">[</span><span class="n">Alpha</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Beta</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Gamma</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Delta</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Table</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">If</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">UnsameQ</span><span class="p">[</span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">]],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">Subscript</span><span class="p">[</span><span class="n">Superscript</span><span class="p">[</span><span class="s">&#34;R&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="p">]]}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">l</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Partition</span><span class="p">[</span><span class="n">DeleteCases</span><span class="p">[</span><span class="n">Flatten</span><span class="p">[</span><span class="n">list</span><span class="p">],</span><span class="w"> </span><span class="n">Null</span><span class="p">],</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">TableForm</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
\left(
\begin{array}{cc}
 \text{R}^0{}_{1,1,0} & -F^{(0,1)}(t,r) G^{(0,1)}(t,r)+e^{2 G(t,r)-2 F(t,r)} \left(F^{(1,0)}(t,r) G^{(1,0)}(t,r)-G^{(1,0)}(t,r)^2-G^{(2,0)}(t,r)\right)+F^{(0,1)}(t,r)^2+F^{(0,2)}(t,r) \\
 \text{R}^0{}_{2,2,0} & r F^{(0,1)}(t,r) e^{-2 G(t,r)} \\
 \text{R}^0{}_{2,2,1} & r e^{-2 F(t,r)} G^{(1,0)}(t,r) \\
 \text{R}^0{}_{3,3,0} & r \sin ^2(\theta) F^{(0,1)}(t,r) e^{-2 G(t,r)} \\
 \text{R}^0{}_{3,3,1} & r \sin ^2(\theta) e^{-2 F(t,r)} G^{(1,0)}(t,r) \\
 \text{R}^1{}_{0,1,0} & e^{2 F(t,r)-2 G(t,r)} \left(-F^{(0,1)}(t,r) G^{(0,1)}(t,r)-e^{2 G(t,r)-2 F(t,r)} \left(-F^{(1,0)}(t,r) G^{(1,0)}(t,r)+G^{(1,0)}(t,r)^2+G^{(2,0)}(t,r)\right)+F^{(0,1)}(t,r)^2+F^{(0,2)}(t,r)\right) \\
 \text{R}^1{}_{2,2,0} & r \left(-e^{-2 G(t,r)}\right) G^{(1,0)}(t,r) \\
 \text{R}^1{}_{2,2,1} & r \left(-e^{-2 G(t,r)}\right) G^{(0,1)}(t,r) \\
 \text{R}^1{}_{3,3,0} & r \sin ^2(\theta) \left(-e^{-2 G(t,r)}\right) G^{(1,0)}(t,r) \\
 \text{R}^1{}_{3,3,1} & r \sin ^2(\theta) \left(-e^{-2 G(t,r)}\right) G^{(0,1)}(t,r) \\
 \text{R}^2{}_{0,2,0} & \frac{F^{(0,1)}(t,r) e^{2 F(t,r)-2 G(t,r)}}{r} \\
 \text{R}^2{}_{0,2,1} & \frac{G^{(1,0)}(t,r)}{r} \\
 \text{R}^2{}_{1,2,0} & \frac{G^{(1,0)}(t,r)}{r} \\
 \text{R}^2{}_{1,2,1} & \frac{G^{(0,1)}(t,r)}{r} \\
 \text{R}^2{}_{3,3,2} & \sin ^2(\theta) \left(e^{-2 G(t,r)}-1\right) \\
 \text{R}^3{}_{0,3,0} & \frac{F^{(0,1)}(t,r) e^{2 F(t,r)-2 G(t,r)}}{r} \\
 \text{R}^3{}_{0,3,1} & \frac{G^{(1,0)}(t,r)}{r} \\
 \text{R}^3{}_{1,3,0} & \frac{G^{(1,0)}(t,r)}{r} \\
 \text{R}^3{}_{1,3,1} & \frac{G^{(0,1)}(t,r)}{r} \\
 \text{R}^3{}_{2,3,2} & 1-e^{-2 G(t,r)} \\
\end{array}
\right)
$$<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="c">(*Ricci 张量*)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="n">Ricci</span><span class="p">[</span><span class="n">CD</span><span class="p">][{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Alpha</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Beta</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Table</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">If</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">UnsameQ</span><span class="p">[</span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]],</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">Subscript</span><span class="p">[</span><span class="s">&#34;R&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]]}],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Partition</span><span class="p">[</span><span class="n">DeleteCases</span><span class="p">[</span><span class="n">Flatten</span><span class="p">[</span><span class="n">list</span><span class="p">],</span><span class="w"> </span><span class="n">Null</span><span class="p">],</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">Simplify</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">TableForm</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
\left(
\begin{array}{cc}
 \text{R}_{0,0} & \frac{e^{-2 G(t,r)} \left(-e^{2 F(t,r)} F^{(0,1)}(t,r) \left(r G^{(0,1)}(t,r)-2\right)+r e^{2 G(t,r)} \left(F^{(1,0)}(t,r) G^{(1,0)}(t,r)-G^{(1,0)}(t,r)^2-G^{(2,0)}(t,r)\right)+r e^{2 F(t,r)} F^{(0,1)}(t,r)^2+r e^{2 F(t,r)} F^{(0,2)}(t,r)\right)}{r} \\
 \text{R}_{1,0} & \frac{2 G^{(1,0)}(t,r)}{r} \\
 \text{R}_{1,1} & F^{(0,1)}(t,r) G^{(0,1)}(t,r)+e^{2 G(t,r)-2 F(t,r)} \left(-F^{(1,0)}(t,r) G^{(1,0)}(t,r)+G^{(1,0)}(t,r)^2+G^{(2,0)}(t,r)\right)-F^{(0,1)}(t,r)^2-F^{(0,2)}(t,r)+\frac{2 G^{(0,1)}(t,r)}{r} \\
 \text{R}_{2,2} & e^{-2 G(t,r)} \left(-r F^{(0,1)}(t,r)+r G^{(0,1)}(t,r)+e^{2 G(t,r)}-1\right) \\
 \text{R}_{3,3} & \sin ^2\theta  e^{-2 G(t,r)} \left(-r F^{(0,1)}(t,r)+r G^{(0,1)}(t,r)+e^{2 G(t,r)}-1\right) \\
\end{array}
\right)
$$<p>由真空中的爱因斯坦方程$R_{\mu\nu} = 0$可知上式任意一项都为0. 根据$R_{10} = \frac{2\partial_t G(t,r)}{r} = 0$，可得$G(t,r) = G(r)$，即与时间无关。同时，观查可知$R_{33} = \sin ^2\theta  e^{-2 G(t,r)} R_{22} $这样可以进一步化简上面的Ricci Tensor:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">GReplace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="o">!</span><span class="err">\</span><span class="p">(</span><span class="err">\</span><span class="o">*</span><span class="n">SuperscriptBox</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">InterpretationBox</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">StyleBox</span><span class="p">[</span><span class="s">&#34;G&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ShowAutoStyles</span><span class="o">-&gt;</span><span class="n">False</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">AutoSpacing</span><span class="o">-&gt;</span><span class="n">False</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">$</span><span class="nn">CellContext`</span><span class="n">G</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Editable</span><span class="o">-&gt;</span><span class="n">False</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TagBox</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">RowBox</span><span class="p">[{</span><span class="s">&#34;(&#34;</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">RowBox</span><span class="p">[{</span><span class="s">&#34;1&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;0&#34;</span><span class="p">}],</span><span class="w"> </span><span class="s">&#34;)&#34;</span><span class="p">}],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Derivative</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">MultilineFunction</span><span class="o">-&gt;</span><span class="n">None</span><span class="p">]</span><span class="err">\</span><span class="p">)[</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="o">!</span><span class="err">\</span><span class="p">(</span><span class="err">\</span><span class="o">*</span><span class="n">SuperscriptBox</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">InterpretationBox</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">StyleBox</span><span class="p">[</span><span class="s">&#34;G&#34;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ShowAutoStyles</span><span class="o">-&gt;</span><span class="n">False</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">AutoSpacing</span><span class="o">-&gt;</span><span class="n">False</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">$</span><span class="nn">CellContext`</span><span class="n">G</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Editable</span><span class="o">-&gt;</span><span class="n">False</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">TagBox</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">RowBox</span><span class="p">[{</span><span class="s">&#34;(&#34;</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">RowBox</span><span class="p">[{</span><span class="s">&#34;2&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;0&#34;</span><span class="p">}],</span><span class="w"> </span><span class="s">&#34;)&#34;</span><span class="p">}],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Derivative</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">MultilineFunction</span><span class="o">-&gt;</span><span class="n">None</span><span class="p">]</span><span class="err">\</span><span class="p">)[</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Ricci</span><span class="p">[</span><span class="n">CD</span><span class="p">][{</span><span class="mi">-0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">GReplace</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Simplify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Ricci</span><span class="p">[</span><span class="n">CD</span><span class="p">][{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">GReplace</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Simplify</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Ricci</span><span class="p">[</span><span class="n">CD</span><span class="p">][{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">GReplace</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Simplify</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216175428572.png"
	width="979"
	height="577"
	srcset="/p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216175428572_hu_3ba37b6136f9193e.png 480w, /p/%E6%96%BD%E7%93%A6%E8%A5%BF%E5%BA%A6%E8%A7%84schwarzchild-metric/image20250216175428572_hu_2c5c7fad90b03405.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="169"
		data-flex-basis="407px"
	
></p>
<p>实际上到这一步剩下的手算也不难了，注意上面的式子都为0，同时没有对时间的导数项，那么总可以重定义$\mathrm{d}t \Rightarrow F(t,r) = F(r)$。那么可以把方程组整理为：</p>
$$
\begin{array}{cc}
\text{F}''(r)+\text{F}'(r) \left(\frac{2}{r}-\text{G}'(r)\right)+\text{F}'(r)^2=0,\\
-\text{F}''(r)+\text{F}'(r) \text{G}'(r)-\text{F}'(r)^2+\frac{2 \text{G}'(r)}{r}=0,\\
e^{-2 \text{G}(r)} \left(r \left(\text{G}'(r)-\text{F}'(r)\right)-1\right)+1=0
\end{array}
$$<p>待求解的只有$F(r)$和$G(r)$，只需要两个方程，把第一式与第二式相加后，得到的方程$\frac{F^\prime(r)+G^\prime(r)}{r}=0$可知$G(r) = -F(r)$，那么只需解出$F(r)$，利用DSolve求解</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Swarchildsolution</span><span class="w"> </span><span class="o">=</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">DSolve</span><span class="p">[{</span><span class="n">E</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="n">F</span><span class="p">[</span><span class="n">r</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">r</span><span class="w">  </span><span class="n">Derivative</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">F</span><span class="p">][</span><span class="n">r</span><span class="p">])</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="n">F</span><span class="p">[</span><span class="n">r</span><span class="p">],</span><span class="w"> </span><span class="n">r</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>可得
</p>
$$
\left\{\left\{F(r)\to \log \left(-\sqrt{1+\frac{e^{2 c_1}}{r}}\right)\right\},\left\{F(r)\to \frac{1}{2} \log \left(1+\frac{e^{2 c_1}}{r}\right)\right\}\right\}
$$<p>
第一个解显然不物理，根据弱场条件需要回到牛顿引力可以得到$e^{2c_1} = 2 G M =R_s $，这样就得到了最终的施瓦西解：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Print</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="s">&#34;\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)=&#34;</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">ComponentArray</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">g</span><span class="p">[{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> </span><span class="n">ch</span><span class="p">}]]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="p">{</span><span class="n">F</span><span class="p">[</span><span class="n">t</span><span class="p">[],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">r</span><span class="p">[]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="err">\</span><span class="o">!</span><span class="err">\</span><span class="p">(</span><span class="n">TraditionalForm</span><span class="err">\`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="o">*</span><span class="n">FractionBox</span><span class="p">[</span><span class="err">\</span><span class="p">(</span><span class="mi">1</span><span class="err">\</span><span class="p">),</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="mi">2</span><span class="err">\</span><span class="p">)]</span><span class="w"> </span><span class="n">Log</span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="o">*</span><span class="n">FractionBox</span><span class="p">[</span><span class="err">\</span><span class="p">(</span><span class="n">Rs</span><span class="err">\</span><span class="p">),</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="n">r</span><span class="err">\</span><span class="p">)]]</span><span class="err">\</span><span class="p">),</span><span class="w"> </span><span class="n">G</span><span class="p">[</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">-</span><span class="err">\</span><span class="o">!</span><span class="err">\</span><span class="p">(</span><span class="n">TraditionalForm</span><span class="err">\`</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="o">*</span><span class="n">FractionBox</span><span class="p">[</span><span class="err">\</span><span class="p">(</span><span class="mi">1</span><span class="err">\</span><span class="p">),</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="mi">2</span><span class="err">\</span><span class="p">)]</span><span class="w"> </span><span class="n">Log</span><span class="p">[</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="o">*</span><span class="n">FractionBox</span><span class="p">[</span><span class="err">\</span><span class="p">(</span><span class="n">Rs</span><span class="err">\</span><span class="p">),</span><span class="w"> </span><span class="err">\</span><span class="p">(</span><span class="n">r</span><span class="err">\</span><span class="p">)]]</span><span class="err">\</span><span class="p">)}]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">MatrixForm</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
g_{\mu \nu }=\left(
\begin{array}{cccc}
 \frac{R_s}{r}-1 & 0 & 0 & 0 \\
 0 & \frac{1}{1-\frac{R_s}{r}} & 0 & 0 \\
 0 & 0 & r^2 & 0 \\
 0 & 0 & 0 & r^2 \sin ^2(\theta ) \\
\end{array}
\right)
$$<h2 id="施瓦西度规的测地线方程">施瓦西度规的测地线方程
</h2><p>广义相对论中，测地线就是指自由粒子在弯曲时空中的运动，“自由”指的是其固有加速度为0，具体的形式为
</p>
$$
\frac{\mathrm{d}^2 x^\mu}{\mathrm{d}\lambda^2} + \Gamma^{\mu}_{\alpha\beta} \frac{\mathrm{d}x^\alpha}{\mathrm{d}\lambda} \frac{\mathrm{d}x^\beta}{\mathrm{d}\lambda}=0 ~,
$$<p>
其中$\lambda$是仿射参量，在类时测地线一般就是固有时$\tau$，对于零测地线，由于其任意两点的间隔都为0，所以需要取另外的放射参量。在这里，我们计算施瓦西度规下的测地线方程，为了减少可能出现的一些报错，我们新建一个文件，把计算好的度规直接定义好</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Needs</span><span class="p">[</span><span class="s">&#34;xAct`xCoba`&#34;</span><span class="p">]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefManifold</span><span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="err">\</span><span class="p">[</span><span class="n">Alpha</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Beta</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Lambda</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Sigma</span><span class="p">],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Rho</span><span class="p">]}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">coords</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">t</span><span class="p">[],</span><span class="w"> </span><span class="n">r</span><span class="p">[],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][],</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][]};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefConstantSymbol</span><span class="p">[</span><span class="n">Rs</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#34;\!\(\*SubscriptBox[\(R\), \(s\)]\)&#34;</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Rs</span><span class="o">/</span><span class="n">r</span><span class="p">[];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Rs</span><span class="o">/</span><span class="n">r</span><span class="p">[]);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g33</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">Sin</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]]</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gmatrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="n">g00</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">g11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">g22</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">g33</span><span class="p">}}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefChart</span><span class="p">[</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">coords</span><span class="p">,</span><span class="w"> </span><span class="n">ChartColor</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Blue</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CTensor</span><span class="p">[</span><span class="n">gmatrix</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">SetCMetric</span><span class="p">[</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="p">,</span><span class="w"> </span><span class="n">SignatureOfMetric</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CovDOfMetric</span><span class="p">[</span><span class="n">g</span><span class="p">];</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>同样，把联络计算好</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">Christoffel</span><span class="p">[</span><span class="n">CD</span><span class="p">,</span><span class="w"> </span><span class="n">PDch</span><span class="p">][{</span><span class="err">\</span><span class="p">[</span><span class="n">Lambda</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Table</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">If</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">UnsameQ</span><span class="p">[</span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">]],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="n">Subscript</span><span class="p">[</span><span class="n">Superscript</span><span class="p">[</span><span class="s">&#34;\[CapitalGamma]&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">list</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">]]}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">list</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Partition</span><span class="p">[</span><span class="n">DeleteCases</span><span class="p">[</span><span class="n">Flatten</span><span class="p">[</span><span class="n">list</span><span class="p">],</span><span class="w"> </span><span class="n">Null</span><span class="p">],</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">TableForm</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
\left(
\begin{array}{cc}
 \Gamma ^0{}_{1,0} & -\frac{R_s}{2 r  R_s-2 r ^2} \\
 \Gamma ^1{}_{0,0} & -\frac{R_s (R_s-r )}{2 r ^3} \\
 \Gamma ^1{}_{1,1} & \frac{R_s}{2 r  R_s-2 r ^2} \\
 \Gamma ^1{}_{2,2} & R_s-r  \\
 \Gamma ^1{}_{3,3} & \sin ^2(\theta  ) (R_s-r ) \\
 \Gamma ^2{}_{2,1} & \frac{1}{r } \\
 \Gamma ^2{}_{3,3} & \sin (\theta  ) (-\cos (\theta  )) \\
 \Gamma ^3{}_{3,1} & \frac{1}{r } \\
 \Gamma ^3{}_{3,2} & \cot (\theta  ) \\
\end{array}
\right)
$$<p>接下来定义四速度，那么测地线方程可以写为
</p>
$$
\frac{\mathrm{d}u^\mu}{\mathrm{d}\lambda} + \Gamma^\mu_{\alpha\beta} \
u^\alpha u^\beta = 0
$$<p>
计算$ \Gamma^\mu _{\alpha\beta}
u^\alpha u^\beta $ :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">DefTensor</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Alpha</span><span class="p">]],</span><span class="w"> </span><span class="n">M</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">gEqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ComponentArray</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">Christoffel</span><span class="p">[</span><span class="n">CD</span><span class="p">,</span><span class="w"> </span><span class="n">PDch</span><span class="p">][{</span><span class="err">\</span><span class="p">[</span><span class="n">Lambda</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="o">-</span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> </span><span class="o">-</span><span class="n">ch</span><span class="p">}]</span><span class="w"> </span><span class="n">u</span><span class="p">[{</span><span class="err">\</span><span class="p">[</span><span class="n">Mu</span><span class="p">],</span><span class="w"> </span><span class="n">ch</span><span class="p">}]</span><span class="w"> </span><span class="n">u</span><span class="p">[{</span><span class="err">\</span><span class="p">[</span><span class="n">Nu</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">ch</span><span class="p">}]]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">ContractBasis</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Simplify</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>利用For循环，把所有测地线方程写出来</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">For</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">gEqs</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">Print</span><span class="p">[</span><span class="s">&#34;\!\(\*FractionBox[\(d\), \(d\\\ \[Tau]\)]\)&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">[{</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="p">}],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;+(&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">gEqs</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span><span class="w"> </span><span class="s">&#34;)=0&#34;</span><span class="p">]]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
\begin{split}
&\frac{d}{d \tau }u^0\text{+(}-\frac{\text{R}_s u^0 u^1}{R_s r-r^2}\text{)=0}\\
& \frac{d}{d \tau }u^1\text{+(}\frac{r^2 \left(2 r \left(u^0 u^0+\sin ^2(\theta ) u^1 u^1\right) (R_s-r)^2+R_s u^2 u^2 \right)-R_s (R_s-r)^2 u^3 u^3}{2 (R_s-r) r^3}\text{)=0}\\
& \frac{d}{d\tau }u^2\text{+(}\frac{2 u^1 u^2}{r}-\cos (\theta ) \sin (\theta ) u^3 u^3 \text{)=0}\\
& \frac{d}{d \tau }u^3\text{+(}\frac{2 (u^1 +\cot (\theta ) r u^2) u^3}{r}\text{)=0}
\end{split}
$$<p>可以改成我们更熟悉的形式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">dt</span><span class="w">  </span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;\!\(\*OverscriptBox[\(t\), \(.\)]\)&#34;</span><span class="p">];</span><span class="w"> </span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">dr</span><span class="w">  </span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#34;\!\(\*OverscriptBox[\(r\), \(.\)]\)&#34;</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">]</span><span class="w">  </span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;\!\(\*OverscriptBox[\(\[Theta]\), \(.\)]\)&#34;</span><span class="p">];</span><span class="w"> </span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">d</span><span class="err">\</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">]</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#34;\!\(\*OverscriptBox[\(\[Phi]\), \(.\)]\)&#34;</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">ddt</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;\!\(\*OverscriptBox[\(t\), \(¨\)]\)&#34;</span><span class="p">];</span><span class="w"> </span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">ddr</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#34;\!\(\*OverscriptBox[\(r\), \(¨\)]\)&#34;</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">dd</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;\!\(\*OverscriptBox[\(\[Theta]\), \(¨\)]\)&#34;</span><span class="p">];</span><span class="w"> </span><span class="n">DefScalarFunction</span><span class="p">[</span><span class="n">dd</span><span class="err">\</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">],</span><span class="w"> </span><span class="n">PrintAs</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&#34;\!\(\*OverscriptBox[\(\[Phi]\), \(¨\)]\)&#34;</span><span class="p">];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">u</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">CTensor</span><span class="p">[{</span><span class="n">dt</span><span class="p">[]</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">dr</span><span class="p">[]</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][]</span><span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">ch</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">du</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CTensor</span><span class="p">[{</span><span class="n">ddt</span><span class="p">[],</span><span class="w"> </span><span class="n">ddr</span><span class="p">[],</span><span class="w"> </span><span class="n">dd</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][],</span><span class="w"> </span><span class="n">dd</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][]},</span><span class="w"> </span><span class="p">{</span><span class="n">ch</span><span class="p">}];</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">{</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">du</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">For</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">gEqs</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">Print</span><span class="p">[</span><span class="s">&#34;\!\(\*FractionBox[\(d\), \(d\\\ \[Tau]\)]\)&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">[{</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="p">}],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="s">&#34;+(&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">gEqs</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span><span class="w"> </span><span class="s">&#34;)=0&#34;</span><span class="p">]]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
\begin{split}
& \frac{d}{d \tau }\text{dt}\text{+(}-\frac{R_s \text{dr} \text{dt}}{R_s r-r^2}\text{)=0} \\
& \frac{d}{d \tau }\text{dr}\text{+(}\frac{r^2 \left(R_s \text{dr}^2+2 (R_s-r)^2 r \left(\text{d$\theta $}^2+\text{d$\phi $}^2 \sin ^2(\theta )\right)\right)-R_s \text{dt}^2 (R_s-r)^2}{2 (R_s-r) r^3}\text{)=0}\\
& \frac{d}{d \tau }\text{d$\theta $}\text{+(}\frac{2 \text{dr} \text{d$\theta $}}{r}-\cos (\theta ) \text{d$\phi $}^2 \sin (\theta )\text{)=0}
\\
&\frac{d}{d \tau }\text{d$\phi $}\text{+(}\frac{2 \text{d$\phi $} (\text{dr}+\cot (\theta ) \text{d$\theta $} r)}{r}\text{)=0}
\end{split}
$$<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">For</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Length</span><span class="p">[</span><span class="n">gEqs</span><span class="p">],</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">Print</span><span class="p">[</span><span class="n">du</span><span class="p">[{</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ch</span><span class="p">}],</span><span class="w"> </span><span class="s">&#34;+(&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">gEqs</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span><span class="w"> </span><span class="s">&#34;)=0&#34;</span><span class="p">]]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div>$$
\begin{split}
& \ddot{t}\text{+(}-\frac{R_s \dot{r} \dot{t}}{R_s r-r^2}\text{)=0}\\
& \ddot{r}\text{+(}\frac{r^2 \left(R_s \dot{r}^2+2 (R_s-r)^2 r \left(\dot{\theta}^2+\dot{\phi}^2 \sin ^2(\theta )\right)\right)-R_s \dot{t}^2 (R_s-r)^2}{2 (R_s-r) r^3}\text{)=0}\\
& \ddot{\theta}\text{+(}\frac{2 \dot{r} \dot{\theta}}{r}-\cos (\theta ) \dot{\phi}^2 \sin (\theta )\text{)=0}
\\
&\ddot{\phi}\text{+(}\frac{2 \dot{\phi} (\dot{r}+\cot (\theta ) \dot{\theta} r)}{r}\text{)=0}
\end{split}
$$<h2 id="数值求解测地线方程">数值求解测地线方程
</h2><p>测地线方程有更简单的求法，可以通过找守恒量消除方程的一些冗余度，但是这里采用<strong>最原始粗暴</strong>的算法<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>。</p>
<p>先给定初始条件，这里是类时测地线，有$g_{\mu\nu}u^\mu u^\nu =0$，为简单考虑，选取$\theta = \frac{\pi}{2}$的平面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">r0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">Rs</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Pi</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Rs</span><span class="o">/</span><span class="n">r0</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">dt0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sqrt</span><span class="p">[(</span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">r0</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">]</span><span class="mi">0</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Rs</span><span class="o">/</span><span class="n">r0</span><span class="p">)];</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>第二个式子改成要求解的方程比较复杂，可以采用如下方式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="p">(</span><span class="o">-</span><span class="n">Rs</span><span class="w"> </span><span class="n">dt</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">r</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="n">dr</span><span class="p">[]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">r</span><span class="p">[]</span><span class="w"> </span><span class="p">(</span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">Sin</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]]</span><span class="o">^</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[])</span><span class="w"> </span><span class="n">r</span><span class="p">[]</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="p">{</span><span class="n">dt</span><span class="p">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dt</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w"> </span><span class="n">r</span><span class="p">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">dr</span><span class="p">[]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dr</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">Sin</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">\</span><span class="p">[</span><span class="n">Theta</span><span class="p">][]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>下面数值求解微分方程组，参数为固有时[Tau]，把二阶微分方程转化为一阶微分方程，给出初始条件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">Eqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">t</span><span class="err">&#39;</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">dt</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">r</span><span class="err">&#39;</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">dr</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">]</span><span class="err">&#39;</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">dt</span><span class="err">&#39;</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">Rs</span><span class="w"> </span><span class="n">dr</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="n">dt</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]])</span><span class="o">/</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">Rs</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="o">^</span><span class="mi">2</span><span class="p">)))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">dr</span><span class="err">&#39;</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="n">Rs</span><span class="w"> </span><span class="n">dt</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="n">dr</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="mi">2</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]])</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="mi">2</span><span class="w"> </span><span class="p">(</span><span class="n">Rs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]])</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">]</span><span class="err">&#39;</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="n">dr</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]])</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">initialConditions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">dt0</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">r0</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">dr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">]</span><span class="mi">0</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="c">(*数值求解微分方程*)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">traj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NDSolve</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">Join</span><span class="p">[</span><span class="n">Eqs</span><span class="p">,</span><span class="w"> </span><span class="n">initialConditions</span><span class="p">],</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">{</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">],</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">dr</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">]},</span><span class="w"> </span><span class="p">{</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">],</span><span class="w"> </span><span class="mi">-2000</span><span class="p">,</span><span class="w"> </span><span class="mi">20000</span><span class="p">},</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">Method</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="s">&#34;StiffnessSwitching&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;NonstiffTest&#34;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">False</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">];</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>最后给出轨道:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mathematica" data-lang="mathematica"><span class="line"><span class="cl"><span class="n">ParametricPlot</span><span class="p">[</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">Evaluate</span><span class="p">[{</span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="n">Cos</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]],</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">r</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]</span><span class="w"> </span><span class="n">Sin</span><span class="p">[</span><span class="err">\</span><span class="p">[</span><span class="n">Phi</span><span class="p">][</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">]]]}</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="n">traj</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="err">\</span><span class="p">[</span><span class="n">Tau</span><span class="p">],</span><span class="w"> </span><span class="mi">-500</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">},</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">PlotRange</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">All</span><span class="p">,</span><span class="w"> </span><span class="n">AxesLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="s">&#34;x&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;y&#34;</span><span class="p">},</span><span class="w"> </span><span class="n">PlotStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Orange</span><span class="p">,</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Medium</span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250216202839466.png" alt="image-20250216202839466" style="zoom:50%;" />
<p>增大初始角速度$\dot{\phi}$会得到脱离黑洞的轨道，反之则得到掉入奇点的轨道（会报错），这里给一个角速度变为原来1.2倍的结果：</p>
<img src="image-20250216203119595.png" alt="image-20250216203119595" style="zoom:50%;" />
<p>如果把类时测地线改成零测地线($g_{\mu\nu}u^\mu u^\nu = 0$)，可以得到光线偏折的轨迹.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">dt0 = Sqrt[(r0^2 d\[Phi]0^2)/(1 - Rs/r0)];
</span></span></code></pre></td></tr></table>
</div>
</div><img src="image-20250216203720367.png" alt="image-20250216203720367" style="zoom:67%;" />
<blockquote>
<p><a class="link" href="https://physics.ntua.gr/konstant/GR/xAct.html"  target="_blank" rel="noopener"
    >https://physics.ntua.gr/konstant/GR/xAct.html</a></p>
<p>陈斌 .《广义相对论导论》. 北京大学出版社. 2022</p>
</blockquote>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>反正用电脑数值求解。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI&#43;WdtXRGWt2kTvGFasHpSy3SV"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG&#43;vnGctmUb0ZY0l8"crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"integrity="sha384-&#43;VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4&#43;/RRE05"crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
	const mainArticleElement = document.querySelector(".main-article");
        renderMathInElement(mainArticleElement, {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>

    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/%E7%94%A8mathematica%E9%AA%8C%E8%AF%81%E5%85%8B%E5%B0%94%E5%BA%A6%E8%A7%84/">
        
        
            <div class="article-image">
                <img src="/p/%E7%94%A8mathematica%E9%AA%8C%E8%AF%81%E5%85%8B%E5%B0%94%E5%BA%A6%E8%A7%84/774px-Spinning_and_chargend_black_hole_with_accretion_disk.a163a6a7f65d22108cd2067b4e509995_hu_2422880b006d567a.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 用Mathematica验证克尔度规"
                        
                        data-hash="md5-oWOmp/ZdIhCM0gZ7TlCZlQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">用Mathematica验证克尔度规</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%9B%B8%E5%AF%B9%E8%AE%BA%E4%B8%AD%E7%9A%84%E5%8F%98%E5%88%86/">
        
        
            <div class="article-image">
                <img src="/p/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E7%9B%B8%E5%AF%B9%E8%AE%BA%E4%B8%AD%E7%9A%84%E5%8F%98%E5%88%86/variation.21d5e70b37d9d9949a379bcc36820bf2_hu_97c73650a8b88881.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 学习笔记-相对论中的变分"
                        
                        data-hash="md5-IdXnCzfZ2ZSaN5vMNoIL8g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">学习笔记-相对论中的变分</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E5%BA%A6%E8%A7%84%E6%81%92%E7%AD%89%E5%BC%8F%E6%80%BB%E7%BB%93/">
        
        
            <div class="article-image">
                <img src="/p/%E5%BA%A6%E8%A7%84%E6%81%92%E7%AD%89%E5%BC%8F%E6%80%BB%E7%BB%93/metric.415902e5169535907a22e03a16f01804_hu_62f1dc7c5e280c3.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 度规恒等式总结"
                        
                        data-hash="md5-QVkC5RaVNZB6IuA6FvAYBA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">度规恒等式总结</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%8D%B7%E7%A7%AFconvolution/">
        
        
            <div class="article-image">
                <img src="/p/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E5%8D%B7%E7%A7%AFconvolution/sea.11f97c05285ef66ba92864a6feff49bf_hu_3f3e0fe4130cf989.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post 学习笔记-卷积(convolution)"
                        
                        data-hash="md5-Efl8BShe9mupKGSm/v9Jvw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">学习笔记-卷积(convolution)</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="Dawn-19/Dawn-19.github.io"
        issue-term="pathname"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    let utterancesLoaded = false;

    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;

        
        utterancesLoaded = true;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        if (!utterancesLoaded) return;
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2025 Dawn-19
    </section>
    
    <section class="powerby">
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.30.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
